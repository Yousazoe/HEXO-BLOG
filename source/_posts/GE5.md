---
title: Event System
tags:
  - Cpp
  - Game Engine
categories: 游戏引擎开发 (Game Engine Series)
abbrlink: fe6918d5
date: 2021-02-14 17:53:29
banner_img:
index_img:
comment:
translate_title:
top:
---







![](https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/Eq5wAQ1XMAU2cvz.jpeg)

<div align=center>
  <font size="3">
    <i>
      <a href=" https://twitter.com/m4ndrill">Twitter@m4ndrill</a>
    </i>
  </font>
</div>



### 引言

上一节我们对项目进行重构生成。这节我们将为我们的引擎创建一个事件系统，以便我们处理窗口事件。

<!--more-->



### 准备

我们希望当我们实际创建一个窗口时，我们可以非常轻松地处理所有事情。

目前我们有一个叫`Application`做应用程序的东西，这意味着它实际上包含了使一切保持运行的循环并且一直不断更新我们的游戏。不仅如此，它还要作为事件的枢纽需要接收事件，最终将它们分派到一个`Layer`层中，现在的游戏层是我们以后会讨论的话题所以不会过多地提及它们，因为我们将为此有单独的章节。总之现在事件最终传播到层以便它们可以处理。



根据我们的应用程序，需要有一个应用程序能够接收事件，所以我们来画一些窗口，然后看看这种交流将如何进行。我们的窗口类代表了我们实际构成的窗口，我们的应用程序就像人们熟知的Windows窗口一样，每次我们在此窗口收到事件时是否有人调整了大小、点击关闭按钮、某种鼠标移动事件等等。无论何时每当这些事情发生时，在我们的窗口库或Win32 API都会收到一个事件，然后一旦该事件发生在该窗口类中，我们需要一种将其传达给应用程序的方式。本质上就是窗口类收到一个事件回调，然后构造一个Infinite事件并以某种方式传播回去。



但我们实际上并不想绑定我们的应用程序到窗口类，所以窗口类不应该知道我们的应用程序。所有的应用程序类都会创建一个窗口，所以我们实际上需要做的是将所有这些事件信息发送给应用程序。

例如鼠标右击，我移动了鼠标并在某个位置单击了它，我们需要什么类型的信息呢？需要确定鼠标点击的X&Y坐标以及哪个按钮被按下，然后我们可以处理该信息，这就是所谓的鼠标按下事件。





### Event.h

首先我们有一个事件类型的枚举类`EventType`，应用程序事件`ApplicationEvent.h`覆盖了所有这些事件：按键事件、鼠标事件等等这些内容